description: Checks for MSSQL role, MSSQL Database Server
# includes: from more specific to less specific
# includes: [ first, second ] - checks from first will override checks from second
includes: [ common, win.poa.managed.fw, wpe.poa.managed.fw ]
firewall:
  - name: gr_tcp_out_backnet
    description: Group for outgoing TCP connections in backnet
    group: yes
    policy: allow
    type: infra
    networks: [backnet]
    direction: outgoing
    protos: [tcp]
    rules:
      - ports: 8352
        connect_with: {roles: [custbackup]}
      - ports: 3306
        protos: [udp]
        connect_with: {roles: [mssqlcluster]}
  - name: Incoming_from_public
    description: "Allow access to hosting services"
    policy: allow
    direction: incoming
    networks: [frontnet]
    protos: [TCP]
    ports: 1433
    type: internet
    connect_with:
      hosts: any

