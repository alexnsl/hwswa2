description: Checks for MSSQL role, MSSQL Database Server
# includes: from more specific to less specific
# includes: [ first, second ] - checks from first will override checks from second
includes: [ wincommon, win.poa.managed.fw, wpe.poa.managed.fw ]
firewall:
  - name: gr_tcp_out_backnet
    description: Group for outgoing TCP connections in backnet
    group: yes
    policy: allow
    type: infra
    networks: [backnet]
    direction: outgoing
    protos: [tcp]
    rules:
      - ports: 8352
        connect_with: {roles: [custbackup]}
      - ports: 3306
        protos: [udp]
        connect_with: {roles: [mssqlcluster]}
  - name: Incoming_from_public
    description: "Allow access to hosting services"
    policy: allow
    direction: incoming
    networks: [frontnet]
    protos: [TCP]
    ports: 1433
    type: internet
    connect_with:
      hosts: any
requirements:
  OS_LP: "^Microsoft Windows Server 2008 ((Standard|Enterprise|Datacenter)|R2 (Enterprise|Datacenter) Service Pack 1)$"
  OSLanguage: en-US
  cpu-cores: 2
  cpu-frequency: 2.3
  ram(GB): 4
  'C:': 40
  'D:': 100
  networks: [backnet]
